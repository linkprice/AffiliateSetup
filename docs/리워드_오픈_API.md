# 리워드 API

## 1. 리워드의 개요

> 실적 발생 시 어떤 회원의 실적인지 실시간으로 데이터를 받을 수 있습니다.
> 리워드 데이터를 사용하면 회원들에게 가입/구매를 홍보하고, 실적이 발생하면 해당 회원에게 보상해 줄 수 있기 때문에 캐시백 또는 리워드 서비스를 운영하는 어필리에이트에 적합합니다.

![](https://raw.githubusercontent.com/linkprice/AffiliateSetup/master/reward_diagram.png)



1. 배너클릭
2. 클릭 링크에 어필리에이트 회원구분을 위한 u_id를 함께 전송하여 링크프라이스 click 서비스로 이동[(3. u_id를 click과 연동하는 방법 참조)](#uid)
3. click 서비스에서 어필리에이트 정보와 함께 머천트 상품 페이지로 이동
4. 어필리에이트 회원이 머천트 상품 구매시 실적 발생
5. 머천트는 어필리에이트 정보 확인 후, 발생한 실적 데이터를 링크프라이스로 전송
6. 링크프라이스에서 어필리에이트에게 발생한 실적의 리워드 데이터 전송<a name="1-6"></a>
   * 리워드 전송은 AC 리워드 API 승인 후 사용 가능[(4. 리워드 승인 신청 참조)](#rewardJoin)
   * 링크프라이스로부터 리워드 데이터를 받아 처리할 페이지 작성 및 등록[(4. 리워드 승인 신청 참조)](#rewardJoin)
   * 머천트에 따라 리워드 전송 시기 및 금액이 실적 정보와 다를수 있습니다.[(2. 리워드 주의사항 참조)](#warning)
7. 매달 1번 링크프라이스에서 머천트측으로 정산 요청
8. 실적 확정 및 취소
9. 머천트 정산 방식에 따라 일부 실적 리워드 전송[(2. 리워드 주의사항 참조)](#warning)<a name="1-9"></a>
10. 실적 조회 API를 통하여 링크프라이스측으로 실적 조회 요청[(실적조회 API로 이동)](https://github.com/linkprice/AffiliateSetup/blob/master/docs/%EC%8B%A4%EC%A0%81_%EC%A1%B0%ED%9A%8C_%EC%98%A4%ED%94%88_API_v1.6.md)
11. 링크프라이스는 요청받은 실적 데이터 정보를 제공<a name="1-11"></a>
12. 응답받은 데이터를 통해 실적의 확정 또는 취소를 확인
13. 리워드 확정



## 2. <a name="warning">리워드 주의사항</a>

- **AC > 어필리에이트 > 툴박스 > 리워드 API**에서 승인 신청을 합니다. 링크프라이스로부터 승인 후 사용 가능 합니다.
    [(4. 리워드 승인 신청 참조)](#rewardJoin)
- u_id
    - 리워드를 받을 회원의 ID입니다.
    - 클릭링크에 u_id파라미터를 같이 전송합니다.[(3. u_id를 click과 연동하는 방법 참조)](#uid)
    - **길이제한: 50byte**
    - **반드시 url encoding 되어 있어야 합니다.**
- 리워드 실적 받기
    - 모든 머천트가 실시간 실적 전송을 지원하지 않습니다.
    - 머천트에 따라 하루에 1번씩만 실적을 전송하기도 합니다.
    - 머천트에 따라 실시간 실적의 금액은 0으로 전송되고, 익일이나 익익일에 실제 금액이 전송되기도 합니다.
- 하나의 주문은 링크프라이스를 통해 리워드를 받은 이후에, 정산 과정에서 
    - 주문 하나의 전체 실적이 취소되거나 또는 일부 실적이 취소 될 수 있습니다.
    - 실시간 실적 전송시의 같은 주문번호로 새로운 마이너스 실적이 생길 수 있습니다.
    - 머천트 정산 방식에 따라 실시간 실전 전송시의 금액과 정산 이후의 금액이 달라질 수 있습니다.
    - 머천트 정산 날짜는 머천트에 따라 상이합니다.
    - 특히 여행 사이트의 경우에는 실시간 실적은 정산시 일단 전부 취소됩니다. 이후 체크아웃 날짜 기준으로 실제 정산이 되어 , 구매 후 1년 후에 정산이 될 수도 있습니다.



## 3. <a name="uid">u_id를 click과 연동하는 방법</a>

- u_id는 클릭링크에 u_id파라미터를 추가하여 전송 하실 수 있습니다.

- 예) u_id의 값이 exampleId101 일때

    ```html
    https://click.linkprice.com/click.php?m=tmon&a=A100000131&l=0000&u_id=exampleId101
    ```



## 4. <a name="rewardJoin">리워드 승인 신청</a>

- **AC > 어필리에이트 > 툴박스 > 리워드 API** 

- 리워드 승인 신청

    ![](https://raw.githubusercontent.com/linkprice/AffiliateSetup/master/reward_request.png)

- 실적 발생 시 머천트에서 링크프라이스로 실적을 보내주면, 링크프라이스에서 어필리에이트로 리워드 데이터를 전송합니다. 링크프라이스가 전송한 데이터를 받아 처리할 페이지를 개발 되어야 하며, 그 주소를 리워드 승인 후 리워드 API 받을 주소에 저장하셔야 합니다.

    ![](https://raw.githubusercontent.com/linkprice/AffiliateSetup/master/reward_url.png)

- 리워드를 받아 처리하는 페이지의 **타임아웃 시간은 최대 10초**입니다.



## 5. 리워드 조회

- **AC > 어필리에이트 > 툴박스 > 리워드 API** 하단 로그정보 조회 클릭

    ![reward1](https://raw.githubusercontent.com/linkprice/AffiliateSetup/master/reward1.png)

- 로그조회 상단 필터링 부분을 이용하여 원하는 조건으로 조회

    ![reward2](https://raw.githubusercontent.com/linkprice/AffiliateSetup/master/reward2.png)

- 전송이 실패한 건에 대해서는 재전송이 가능합니다.
    (재전송 시 실적이 중복 될수 있습니다.)
